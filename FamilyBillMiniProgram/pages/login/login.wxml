<!--pages/login/login.wxml-->
<view class="login-container">
  <view class="login-header">
    <image class="login-logo" src="/images/logo.png" mode="aspectFit"></image>
    <text class="login-title">家庭账单管理</text>
    <text class="login-subtitle">记录每一笔收支，管理家庭财务</text>
  </view>

  <view class="login-content">
    <view class="login-form">
      <view class="input-group">
        <text class="input-label">邮箱</text>
        <input class="input-field" type="email" placeholder="请输入邮箱" value="{{email}}" bindinput="onEmailInput" />
      </view>
      
      <view class="input-group">
        <text class="input-label">密码</text>
        <input class="input-field" type="password" placeholder="请输入密码" value="{{password}}" bindinput="onPasswordInput" />
      </view>

      <button class="btn btn-primary btn-large login-btn" bindtap="onLogin" disabled="{{loading}}">
        {{loading ? '登录中...' : '登录'}}
      </button>

      <view class="login-divider">
        <text class="divider-text">或</text>
      </view>

      <button class="btn btn-secondary btn-large wechat-btn" open-type="getUserInfo" bindgetuserinfo="onWeChatLogin" disabled="{{loading}}">
        <image class="wechat-icon" src="/images/wechat.png"></image>
        微信快速登录
      </button>
    </view>

    <view class="login-footer">
      <text class="register-link" bindtap="onRegister">还没有账号？立即注册</text>
    </view>
  </view>
</view>

<!-- 注册弹窗 -->
<view class="register-modal" wx:if="{{showRegisterModal}}">
  <view class="modal-mask" bindtap="hideRegisterModal"></view>
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">用户注册</text>
      <text class="modal-close" bindtap="hideRegisterModal">×</text>
    </view>
    
    <view class="modal-body">
      <view class="input-group">
        <text class="input-label">邮箱</text>
        <input class="input-field" type="email" placeholder="请输入邮箱" value="{{registerForm.email}}" bindinput="onRegisterEmailInput" />
      </view>
      
      <view class="input-group">
        <text class="input-label">验证码</text>
        <view class="code-input-wrapper">
          <input class="input-field code-input" type="number" maxlength="6" placeholder="请输入6位验证码" value="{{registerForm.verificationCode}}" bindinput="onRegisterCodeInput" />
          <button class="btn btn-secondary btn-small send-code-btn" bindtap="onSendCode" disabled="{{codeSending || countdown > 0}}">
            {{countdown > 0 ? countdown + 's' : (codeSending ? '发送中...' : '获取验证码')}}
          </button>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">密码</text>
        <input class="input-field" type="password" placeholder="请输入密码（至少6位）" value="{{registerForm.password}}" bindinput="onRegisterPasswordInput" />
      </view>
      
      <view class="input-group">
        <text class="input-label">确认密码</text>
        <input class="input-field" type="password" placeholder="请再次输入密码" value="{{registerForm.confirmPassword}}" bindinput="onRegisterConfirmPasswordInput" />
      </view>
      
      <view class="input-group">
        <text class="input-label">昵称（可选）</text>
        <input class="input-field" type="text" placeholder="请输入昵称" value="{{registerForm.nickName}}" bindinput="onRegisterNickNameInput" />
      </view>
    </view>
    
    <view class="modal-footer">
      <button class="btn btn-secondary" bindtap="hideRegisterModal">取消</button>
      <button class="btn btn-primary" bindtap="onRegisterSubmit" disabled="{{registerLoading}}">
        {{registerLoading ? '注册中...' : '注册'}}
      </button>
    </view>
  </view>
</view>